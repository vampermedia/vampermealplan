<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Meal Planner</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Print Styles -->
    <style>
        @media print {
            body {
                background-color: white;
                color: black;
            }
            .print\:hidden {
                display: none !important;
            }
            main {
                padding: 0 !important;
                margin: 0 !important;
                width: 100% !important;
                display: block !important;
            }
            .grid-cols-7 {
                display: grid !important;
                grid-template-columns: repeat(7, minmax(0, 1fr)) !important;
            }
            * {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            .shadow-lg, .rounded-xl {
                box-shadow: none !important;
                border-radius: 0 !important;
            }
            .border {
                border-color: #e5e7eb !important;
            }
            @page {
                size: landscape;
                margin: 0.5cm;
            }
        }
    </style>
</head>
<body class="bg-gray-50 font-sans text-gray-800">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- Icons (Inline SVGs to avoid build steps) ---
        const Icons = {
            Utensils: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"/><path d="M7 2v20"/><path d="M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7"/></svg>,
            Printer: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><rect x="6" y="14" width="12" height="8"/></svg>,
            Trash2: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/></svg>,
            Settings: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>,
            Coffee: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M18 8h1a4 4 0 0 1 0 8h-1"/><path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"/><line x1="6" y1="1" x2="6" y2="4"/><line x1="10" y1="1" x2="10" y2="4"/><line x1="14" y1="1" x2="14" y2="4"/></svg>,
            Palette: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12 19l7-7 3 3-7 7-3-3z"/><path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"/><path d="M2 2l7.586 7.586"/><circle cx="11" cy="11" r="2"/></svg>,
            Plus: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>,
            X: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
        };

        // --- Data & Constants ---
        const INITIAL_BREAKFAST_MEALS = [
            { id: 'b1', name: 'Ginisang Ampalaya + Beef Loaf', category: 'breakfast' },
            { id: 'b2', name: 'Tortang Talong + Ham/Bacon', category: 'breakfast' },
            { id: 'b3', name: 'Egg noodles + Omelette', category: 'breakfast' },
            { id: 'b4', name: 'Canned tuna + egg', category: 'breakfast' },
            { id: 'b5', name: 'Pork/Chicken Adobo (Baon)', category: 'breakfast' },
            { id: 'b6', name: 'Corned beef with potatoes', category: 'breakfast' },
            { id: 'b7', name: 'Pork bola-bola', category: 'breakfast' },
            { id: 'b8', name: 'Hotdogs + fried eggs', category: 'breakfast' },
            { id: 'b9', name: 'Fried chicken + mushroom soup', category: 'breakfast' },
        ];

        const INITIAL_MAIN_MEALS = [
            { id: 'm1', name: 'Chopsuey', category: 'main' },
            { id: 'm2', name: 'Afritada', category: 'main' },
            { id: 'm3', name: 'Pork BBQ + cucumber salad', category: 'main' },
            { id: 'm4', name: 'Pork Nilaga', category: 'main' },
            { id: 'm5', name: 'Pancit Canton Guisado', category: 'main' },
            { id: 'm6', name: 'Fish Paksiw', category: 'main' },
            { id: 'm7', name: 'Ginisang Monggo', category: 'main' },
            { id: 'm8', name: 'Pakbet', category: 'main' },
            { id: 'm9', name: 'Chicken Tinola', category: 'main' },
            { id: 'm10', name: 'Law-uy', category: 'main' },
            { id: 'm11', name: 'Igado / Liver Adobo', category: 'main' },
            { id: 'm12', name: 'Fish Tinola', category: 'main' },
            { id: 'm13', name: 'Garlic butter shrimp', category: 'main' },
            { id: 'm14', name: 'Humba', category: 'main' },
            { id: 'm15', name: 'Pork giniling w/ veggies', category: 'main' },
            { id: 'm16', name: 'Escabeche (fish)', category: 'main' },
            { id: 'm17', name: 'Ginisang upo', category: 'main' },
            { id: 'm18', name: 'Eggplant stir-fry w/ pork', category: 'main' },
        ];

        const THEMES = {
            emerald: { primary: 'bg-emerald-600', secondary: 'bg-emerald-100', border: 'border-emerald-200', text: 'text-emerald-800', hover: 'hover:bg-emerald-50' },
            blue: { primary: 'bg-blue-600', secondary: 'bg-blue-100', border: 'border-blue-200', text: 'text-blue-800', hover: 'hover:bg-blue-50' },
            rose: { primary: 'bg-rose-600', secondary: 'bg-rose-100', border: 'border-rose-200', text: 'text-rose-800', hover: 'hover:bg-rose-50' },
            orange: { primary: 'bg-orange-600', secondary: 'bg-orange-100', border: 'border-orange-200', text: 'text-orange-800', hover: 'hover:bg-orange-50' },
            slate: { primary: 'bg-slate-700', secondary: 'bg-slate-100', border: 'border-slate-300', text: 'text-slate-800', hover: 'hover:bg-slate-50' },
        };

        // --- Main App Component ---
        function App() {
            const [mealCount, setMealCount] = useState(3);
            const [currentTheme, setCurrentTheme] = useState('emerald');
            const [assignments, setAssignments] = useState({});
            const [draggingMeal, setDraggingMeal] = useState(null);

            // Meal List State
            const [breakfastMeals, setBreakfastMeals] = useState(INITIAL_BREAKFAST_MEALS);
            const [mainMeals, setMainMeals] = useState(INITIAL_MAIN_MEALS);
            
            // New Meal Input State
            const [newMealName, setNewMealName] = useState('');
            const [newMealCategory, setNewMealCategory] = useState('main');

            const daysOfWeek = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            const totalDays = 28;
            const theme = THEMES[currentTheme];

            // Drag and Drop Handlers
            const handleDragStart = (e, meal) => {
                setDraggingMeal(meal);
                e.dataTransfer.setData("meal", JSON.stringify(meal));
                e.dataTransfer.effectAllowed = "copy";
            };

            const handleDragOver = (e) => {
                e.preventDefault();
                e.dataTransfer.dropEffect = "copy";
            };

            const handleDrop = (e, dayIndex, slotIndex) => {
                e.preventDefault();
                const mealData = e.dataTransfer.getData("meal");
                
                if (mealData) {
                    const meal = JSON.parse(mealData);
                    const key = `${dayIndex}-${slotIndex}`;
                    setAssignments(prev => ({
                        ...prev,
                        [key]: meal
                    }));
                }
                setDraggingMeal(null);
            };

            const removeAssignment = (dayIndex, slotIndex) => {
                const key = `${dayIndex}-${slotIndex}`;
                const newAssignments = { ...assignments };
                delete newAssignments[key];
                setAssignments(newAssignments);
            };

            // Board Actions
            const clearBoard = () => {
                if (window.confirm("Are you sure you want to clear the entire calendar?")) {
                    setAssignments({});
                }
            };

            const printCalendar = () => {
                window.print();
            };

            // List Management Handlers
            const handleAddMeal = (e) => {
                e.preventDefault();
                if (!newMealName.trim()) return;

                const newMeal = {
                    id: Date.now().toString(),
                    name: newMealName,
                    category: newMealCategory
                };

                if (newMealCategory === 'breakfast') {
                    setBreakfastMeals([...breakfastMeals, newMeal]);
                } else {
                    setMainMeals([...mainMeals, newMeal]);
                }
                setNewMealName('');
            };

            const handleDeleteMeal = (id, category) => {
                if (window.confirm('Delete this meal from your list?')) {
                    if (category === 'breakfast') {
                        setBreakfastMeals(breakfastMeals.filter(m => m.id !== id));
                    } else {
                        setMainMeals(mainMeals.filter(m => m.id !== id));
                    }
                }
            };

            return (
                <div className={`min-h-screen bg-gray-50 font-sans text-gray-800 flex flex-col`}>
                    {/* Header - Hidden on Print */}
                    <header className={`print:hidden ${theme.primary} text-white shadow-md p-4 sticky top-0 z-10`}>
                        <div className="container mx-auto flex flex-col md:flex-row justify-between items-center gap-4">
                            <div className="flex items-center gap-2">
                                <Icons.Utensils className="w-6 h-6" />
                                <h1 className="text-2xl font-bold tracking-tight">Monthly Meal Planner</h1>
                            </div>

                            <div className="flex flex-wrap items-center gap-4 justify-center">
                                {/* Theme Selector */}
                                <div className="flex items-center bg-white/20 rounded-full px-3 py-1 gap-2">
                                    <Icons.Palette className="w-4 h-4 text-white/80" />
                                    {Object.keys(THEMES).map((t) => (
                                        <button
                                            key={t}
                                            onClick={() => setCurrentTheme(t)}
                                            className={`w-5 h-5 rounded-full border-2 ${currentTheme === t ? 'border-white scale-110' : 'border-transparent opacity-70 hover:opacity-100'} transition-all`}
                                            style={{ backgroundColor: t === 'emerald' ? '#059669' : t === 'blue' ? '#2563eb' : t === 'rose' ? '#e11d48' : t === 'orange' ? '#ea580c' : '#334155' }}
                                            title={`Theme: ${t}`}
                                        />
                                    ))}
                                </div>

                                {/* Meal Count Toggle */}
                                <div className="flex bg-white text-gray-800 rounded-lg overflow-hidden text-sm font-medium shadow-sm">
                                    {[1, 2, 3].map(num => (
                                        <button
                                            key={num}
                                            onClick={() => setMealCount(num)}
                                            className={`px-4 py-2 hover:bg-gray-100 transition-colors ${mealCount === num ? `${theme.text} bg-${theme.secondary.split('-')[1]}-200 font-bold` : ''}`}
                                        >
                                            {num} Meal{num > 1 ? 's' : ''}
                                        </button>
                                    ))}
                                </div>

                                <button 
                                    onClick={printCalendar}
                                    className="flex items-center gap-2 bg-white text-gray-800 px-4 py-2 rounded-lg text-sm font-bold shadow hover:bg-gray-100 active:scale-95 transition-transform"
                                >
                                    <Icons.Printer className="w-4 h-4" /> Print
                                </button>
                                
                                <button 
                                    onClick={clearBoard}
                                    className="flex items-center gap-2 bg-red-500 text-white px-3 py-2 rounded-lg text-sm font-bold shadow hover:bg-red-600 active:scale-95 transition-transform"
                                >
                                    <Icons.Trash2 className="w-4 h-4" /> Clear
                                </button>
                            </div>
                        </div>
                    </header>

                    <main className="flex-1 container mx-auto p-4 flex flex-col lg:flex-row gap-6">
                        
                        {/* Sidebar: Meal List - Hidden on Print */}
                        <aside className="print:hidden w-full lg:w-96 flex-shrink-0 bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden h-[85vh] sticky top-24 flex flex-col">
                            <div className={`p-4 ${theme.secondary} border-b ${theme.border}`}>
                                <h2 className={`font-bold ${theme.text} flex items-center gap-2 mb-2`}>
                                    <Icons.Settings className="w-4 h-4" /> Meal Manager
                                </h2>
                                
                                {/* Add Meal Form */}
                                <form onSubmit={handleAddMeal} className="flex flex-col gap-2 bg-white p-2 rounded-lg shadow-sm">
                                    <input
                                        type="text"
                                        placeholder="New meal name..."
                                        value={newMealName}
                                        onChange={(e) => setNewMealName(e.target.value)}
                                        className="w-full px-3 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-emerald-500"
                                    />
                                    <div className="flex gap-2">
                                        <select 
                                            value={newMealCategory} 
                                            onChange={(e) => setNewMealCategory(e.target.value)}
                                            className="flex-1 px-2 py-1.5 text-xs border border-gray-300 rounded focus:outline-none"
                                        >
                                            <option value="breakfast">Breakfast</option>
                                            <option value="main">Lunch/Dinner</option>
                                        </select>
                                        <button 
                                            type="submit"
                                            disabled={!newMealName.trim()}
                                            className={`px-3 py-1 text-white rounded text-sm font-medium flex items-center gap-1 ${!newMealName.trim() ? 'bg-gray-300' : theme.primary}`}
                                        >
                                            <Icons.Plus className="w-4 h-4" /> Add
                                        </button>
                                    </div>
                                </form>
                            </div>
                            
                            <div className="overflow-y-auto flex-1 p-4 space-y-6 scrollbar-thin scrollbar-thumb-gray-200">
                                <div>
                                    <h3 className="text-sm font-bold text-gray-400 uppercase tracking-wider mb-3 flex items-center gap-2">
                                        <Icons.Coffee className="w-4 h-4" /> Breakfast ({breakfastMeals.length})
                                    </h3>
                                    <div className="space-y-2">
                                        {breakfastMeals.length === 0 && <p className="text-xs text-gray-400 italic">No breakfast items.</p>}
                                        {breakfastMeals.map(meal => (
                                            <div
                                                key={meal.id}
                                                draggable
                                                onDragStart={(e) => handleDragStart(e, meal)}
                                                className="p-3 bg-white border border-gray-200 rounded-lg shadow-sm cursor-grab active:cursor-grabbing hover:border-yellow-400 hover:shadow-md transition-all text-sm group relative flex justify-between items-center"
                                            >
                                                <div className="font-medium text-gray-700 pr-6">{meal.name}</div>
                                                <div className="w-1 h-full absolute left-0 top-0 bg-yellow-400 rounded-l-lg opacity-0 group-hover:opacity-100 transition-opacity"></div>
                                                <button 
                                                    onClick={() => handleDeleteMeal(meal.id, 'breakfast')}
                                                    className="text-gray-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity absolute right-2"
                                                    title="Delete meal"
                                                >
                                                    <Icons.X className="w-4 h-4" />
                                                </button>
                                            </div>
                                        ))}
                                    </div>
                                </div>

                                <div>
                                    <h3 className="text-sm font-bold text-gray-400 uppercase tracking-wider mb-3 flex items-center gap-2">
                                        <Icons.Utensils className="w-4 h-4" /> Lunch & Dinner ({mainMeals.length})
                                    </h3>
                                    <div className="space-y-2">
                                        {mainMeals.length === 0 && <p className="text-xs text-gray-400 italic">No main items.</p>}
                                        {mainMeals.map(meal => (
                                            <div
                                                key={meal.id}
                                                draggable
                                                onDragStart={(e) => handleDragStart(e, meal)}
                                                className="p-3 bg-white border border-gray-200 rounded-lg shadow-sm cursor-grab active:cursor-grabbing hover:border-orange-400 hover:shadow-md transition-all text-sm group relative flex justify-between items-center"
                                            >
                                                <div className="font-medium text-gray-700 pr-6">{meal.name}</div>
                                                <div className="w-1 h-full absolute left-0 top-0 bg-orange-400 rounded-l-lg opacity-0 group-hover:opacity-100 transition-opacity"></div>
                                                <button 
                                                    onClick={() => handleDeleteMeal(meal.id, 'main')}
                                                    className="text-gray-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity absolute right-2"
                                                    title="Delete meal"
                                                >
                                                    <Icons.X className="w-4 h-4" />
                                                </button>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        </aside>

                        {/* Main Calendar Area */}
                        <div className="flex-1 bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden print:shadow-none print:border-none print:w-full">
                            {/* Calendar Header */}
                            <div className="grid grid-cols-7 bg-gray-50 border-b border-gray-200">
                                {daysOfWeek.map((day, i) => (
                                    <div key={day} className={`p-2 md:p-3 text-center font-bold text-xs md:text-sm uppercase tracking-wider ${theme.text} ${i === 0 ? 'text-red-500' : ''}`}>
                                        <span className="hidden md:inline">{day}</span>
                                        <span className="md:hidden">{day.slice(0,3)}</span>
                                    </div>
                                ))}
                            </div>

                            {/* Calendar Grid */}
                            <div className="grid grid-cols-7 auto-rows-fr bg-gray-200 gap-px border-b border-gray-200">
                                {Array.from({ length: totalDays }).map((_, dayIndex) => {
                                    return (
                                        <div key={dayIndex} className="bg-white min-h-[150px] flex flex-col relative group">
                                            {/* Day Number (Optional, just visual placeholder) */}
                                            <div className="absolute top-1 right-1 text-[10px] text-gray-300 pointer-events-none">
                                                Day {dayIndex + 1}
                                            </div>

                                            {/* Meal Slots */}
                                            <div className="flex-1 flex flex-col h-full">
                                                {Array.from({ length: mealCount }).map((_, slotIndex) => {
                                                    const assignmentKey = `${dayIndex}-${slotIndex}`;
                                                    const assignedMeal = assignments[assignmentKey];
                                                    const isBreakfast = assignedMeal?.category === 'breakfast';
                                                    
                                                    return (
                                                        <div
                                                            key={slotIndex}
                                                            onDragOver={handleDragOver}
                                                            onDrop={(e) => handleDrop(e, dayIndex, slotIndex)}
                                                            className={`
                                                                flex-1 p-1 border-b border-gray-100 last:border-0 transition-colors relative
                                                                ${!assignedMeal ? theme.hover : ''}
                                                                ${!assignedMeal ? 'bg-white' : isBreakfast ? 'bg-yellow-50' : 'bg-orange-50'}
                                                            `}
                                                        >
                                                            {!assignedMeal && (
                                                                <div className="w-full h-full flex items-center justify-center text-gray-300 text-[10px] uppercase tracking-widest pointer-events-none print:hidden">
                                                                    {mealCount === 1 ? 'Meal' : mealCount === 2 ? (slotIndex === 0 ? 'Lunch' : 'Dinner') : (slotIndex === 0 ? 'B-fast' : slotIndex === 1 ? 'Lunch' : 'Dinner')}
                                                                </div>
                                                            )}

                                                            {assignedMeal && (
                                                                <div className="h-full w-full flex items-start justify-between group/item pl-1">
                                                                    <span className="text-xs md:text-sm font-medium leading-tight text-gray-700 py-1">
                                                                        {assignedMeal.name}
                                                                    </span>
                                                                    <button 
                                                                        onClick={() => removeAssignment(dayIndex, slotIndex)}
                                                                        className="opacity-0 group-hover/item:opacity-100 text-gray-400 hover:text-red-500 p-1 print:hidden"
                                                                    >
                                                                        <Icons.Trash2 className="w-3 h-3" />
                                                                    </button>
                                                                </div>
                                                            )}
                                                        </div>
                                                    );
                                                })}
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>
                        </div>
                    </main>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
